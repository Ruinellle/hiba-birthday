:root{
  --pink1:#ffd2e6;
  --pink2:#ff7db2;
  --pink3:#8f4bff;
  --card: rgba(255,255,255,.22);
  --border: rgba(255,255,255,.35);
  --text: rgba(255,255,255,.95);
  --shadow: 0 18px 60px rgba(0,0,0,.22);
}

*{box-sizing:border-box;}
html,body{height:100%; margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;}
body{overflow:hidden; color:var(--text);}

#app{height:100%; width:100%; position:relative;}

/* Animated gradient background */
#app::before{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(120deg, var(--pink1), var(--pink2), var(--pink3));
  background-size: 200% 200%;
  animation: bg 7s ease-in-out infinite;
  z-index:-2;
}
#app::after{
  content:"";
  position:absolute; inset:-20%;
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.25), transparent 35%),
    radial-gradient(circle at 80% 30%, rgba(255,255,255,.18), transparent 40%),
    radial-gradient(circle at 50% 70%, rgba(255,255,255,.12), transparent 45%);
  filter: blur(2px);
  z-index:-1;
}

@keyframes bg{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.screen{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  opacity:0; pointer-events:none;
  transition: opacity .35s ease;
}
.screen.active{opacity:1; pointer-events:auto;}

.card{
  width:min(720px, 92vw);
  padding:32px 26px;
  border-radius:24px;
  background:var(--card);
  border:1px solid var(--border);
  box-shadow: var(--shadow);
  backdrop-filter: blur(12px);
  text-align:center;
}

.title{font-size:clamp(32px, 5vw, 56px); margin:0 0 10px;}
.subtitle{font-size:clamp(16px, 2.2vw, 22px); margin:0 0 18px; opacity:.95;}

.progress{font-size:14px; opacity:.85; margin-bottom:10px;}
.question{font-size:clamp(20px, 3vw, 30px); margin:10px 0 18px;}

.buttons{display:flex; gap:14px; justify-content:center; flex-wrap:wrap;}
.btn{
  padding:12px 20px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.5);
  background: rgba(0,0,0,.12);
  color:var(--text);
  cursor:pointer;
  font-size:18px;
  transition: transform .1s ease, background .2s ease;
}
.btn:hover{transform: translateY(-1px);}
.btn:active{transform: translateY(1px) scale(.99);}
.btn.primary{
  background: rgba(255,255,255,.22);
  border:1px solid rgba(255,255,255,.65);
}

.tiny{margin:14px 0 0; font-size:14px; opacity:.9; min-height:18px;}

/* Runner canvas (bottom of quiz) */
#runnerCanvas{
  width: min(520px, 92vw);
  height: 90px;
  margin: 18px auto 0;
  display: block;
  border-radius: 14px;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.22);
}

/* Finale */
#screen-finale{align-items:stretch; justify-content:stretch;}
#p5-holder{position:absolute; inset:0;}

.finale-overlay{
  position:absolute; inset:0;
  display:flex; flex-direction:column;
  justify-content:center; align-items:center;
  text-align:center;
  padding:24px;
  pointer-events:none;
  z-index: 3; /* above drifting photos */
}

.finale-title{
  font-size:clamp(34px, 5.4vw, 74px);
  margin:0 0 10px;
  text-shadow: 0 10px 40px rgba(0,0,0,.35);
}
.finale-sub{
  font-size:clamp(16px, 2.2vw, 24px);
  max-width: 900px;
  margin:0;
  opacity:.95;
  text-shadow: 0 10px 40px rgba(0,0,0,.35);
}

/* Drifting photo duplicates (NEW system) */
.photo-gallery{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index: 2; /* above p5, below text */
}

.photo-float{
  position:absolute;
  width:200px;
  border-radius:18px;
  box-shadow:0 22px 60px rgba(0,0,0,.38);
  opacity:0;
  transform: translate(-50%, -50%) scale(.85) rotate(0deg);
  will-change: transform, opacity;
  animation: photoAppear 900ms ease forwards;
}

@keyframes photoAppear{
  to { opacity: 1; }
}

@media (max-width: 700px){
  .photo-float{ width:150px; }
}

/* ---- DRAMA EFFECTS ---- */
.shake { animation: screenShake 380ms ease-in-out; }

@keyframes screenShake {
  0%   { transform: translate(0,0) rotate(0deg); }
  15%  { transform: translate(-8px, 4px) rotate(-0.3deg); }
  30%  { transform: translate(10px, -6px) rotate(0.4deg); }
  45%  { transform: translate(-10px, -2px) rotate(-0.4deg); }
  60%  { transform: translate(8px, 6px) rotate(0.3deg); }
  75%  { transform: translate(-6px, 2px) rotate(-0.2deg); }
  100% { transform: translate(0,0) rotate(0deg); }
}

/* Meme popup: center pop + bounce bigger */
.meme-pop{
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  background: rgba(0,0,0,.28);
}
.meme-pop.show{ display: flex; }

.meme-pop img{
  width: min(460px, 88vw);
  border-radius: 18px;
  box-shadow: 0 30px 90px rgba(0,0,0,.45);
  transform: scale(.2);
  opacity: 0;
  animation: memePopIn 520ms cubic-bezier(.2, 1.4, .3, 1) forwards;
}
@keyframes memePopIn{
  0%   { transform: scale(.2); opacity: 0; }
  55%  { transform: scale(1.08); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

/* YES sparkles/hearts burst particles */
.burst-layer{
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9998;
}
.particle{
  position: absolute;
  font-size: 18px;
  opacity: 0;
  transform: translate(-50%, -50%) scale(.6);
  animation: popFly 720ms ease-out forwards;
  text-shadow: 0 12px 30px rgba(0,0,0,.25);
}
@keyframes popFly{
  0%   { opacity: 0; transform: translate(-50%,-50%) scale(.5); }
  15%  { opacity: 1; transform: translate(-50%,-50%) scale(1); }
  100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(.9); }
}
